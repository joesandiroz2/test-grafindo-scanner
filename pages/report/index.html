<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grafindo Scanner</title>
<!-- Link ke CSS Bootstrap -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/izitoast/dist/css/iziToast.min.css">
<script src="https://cdn.jsdelivr.net/npm/izitoast/dist/js/iziToast.min.js"></script>

<!-- SweetAlert2 CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<!-- SweetAlert2 JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


<style>
@media print{
#print-btn{
display: none;
}
#pagination{
display: none;
}
#search-btn{
display: none;
}
#titlescan{
display: none;
}
#input-no-dn{
display: none;
}
#no_dn_print{
background-color: black;
color: white;
font-weight: bold;
text-align: center;
padding: 3px;
}
}
</style>
</head>
<body>

<!-- Tempat untuk memuat navbar -->
<div id="navbar-container"></div>

<div id="inputcari" class="container card">
<div class="row mt-3">
<div class="col-sm-12 col-md-3 col-lg-3">
<h6 id="titlescan">Scan / input Do disini</h6>
<input type="text" id="input-no-dn" class="form-control" placeholder="Masukkan No DN">

<button id="search-btn" class="btn btn-primary">Cari</button>
<button id="print-btn" class="btn btn-success">Print</button>
<button id="pdf-btn" class="btn btn-warning">PDF</button>
</div>
</div>
</div>


<div class="container">
<div class="card shadow rounded">
<div id="pagination"></div>


<div class="container mt-5" id="loading_report">
<div class="text-center">
<div class="spinner-border" role="status">
<span class="sr-only">Loading...</span>
</div>
<p class="mt-3">Sedang mendapatkan Report ...</p>
</div>
</div>

<div class="row">
<div class="col-sm-2 col-md-2 col-lg-2">
<img 
style="width:80px"
src="../../../logo/grafindo.png" alt="">
</div>
<div class="col-sm-4 col-md-4 col-lg-4">
<p style="color:grey;margin-top:20px;font-size: 10px;">Cikarang Industrial Estate, Jababeka 1 Block U 8D, U 8C & U 7A, Cikarang, Harja Mekar, Cikarang Utara, Harja Mekar, Cikarang Utara, Bekasi Regency, West Java 17530</p>
</div>
<div class="col-sm-6 col-md-6 col-lg-6">
<h6 style="font-weight: bold;margin-top: 40px;">Summary Delivery Report</h6>
</div>
</div>



<div id="data-container"></div>

</div>
</div>





<!-- Link ke jQuery dan JS Bootstrap -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script src="../../js/sdk/pocketbase.umd.js"></script>
<script src="../../js/pocket_config.js"></script>
<script src="./js/report_detail.js"></script>

<script>

$(document).ready(function() {
$("#navbar-container").load("../../component/nav.html",function(){
        setTimeout(loginUser, 500);
    
});


});
document.getElementById("pdf-btn").addEventListener("click", function () {
// Disable buttons and input fields
document.getElementById("navbar-container").style.display = "none";
document.getElementById("pagination").style.display = "none";
document.getElementById("inputcari").style.display = "none";


const { jsPDF } = window.jspdf;

// Mengambil elemen yang ingin dimasukkan ke PDF
const content = document.body; // Mengambil seluruh konten body

// Menggunakan html2canvas untuk menangkap konten
html2canvas(content, {
scrollY: -window.scrollY, // Mengatur scrollY untuk menangkap seluruh konten
useCORS: true // Mengizinkan penggunaan gambar dari domain lain
}).then(canvas => {
const imgData = canvas.toDataURL('image/png');
const doc = new jsPDF();
const imgWidth = 190; // Lebar gambar
const pageHeight = doc.internal.pageSize.height; // Tinggi halaman PDF
const imgHeight = (canvas.height * imgWidth) / canvas.width; // Menghitung tinggi gambar
let heightLeft = imgHeight;

let position = 0;

// Menambahkan gambar ke PDF
doc.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
heightLeft -= pageHeight;

// Jika gambar lebih tinggi dari halaman, tambahkan halaman baru
while (heightLeft >= 0) {
    position = heightLeft - imgHeight;
    doc.addPage();
    doc.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
    heightLeft -= pageHeight;
}

// Menyimpan PDF
doc.save("report.pdf");

// Restore the visibility of the hidden elements
document.getElementById("navbar-container").style.display = "block";
document.getElementById("inputcari").style.display = "block";
document.getElementById("pagination").style.display = "block";

Swal.fire({
    title:"PDF Di Download",
    icon:"success",
    timer:1200
})
}).catch(error => {
console.error("Error capturing content:", error);
document.getElementById("navbar-container").style.display = "block";
document.getElementById("inputcari").style.display = "block";
document.getElementById("pagination").style.display = "block";
});
});
</script>
</body>
<script>
document.getElementById("print-btn").addEventListener("click", function() {
window.print();
});
</script>

</html>