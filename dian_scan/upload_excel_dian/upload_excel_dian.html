<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aplikasi Yamaha</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
 
 <script src="../../js/sdk/pocketbase.umd.js"></script>
<script src="../../js/pocket_config.js"></script>

<script>
const pb = new PocketBase(pocketbaseUrl);
</script>
</head>
<body>

  <div id="navbar-container"></div>

   <div class="container mt-5">
    <h3>Upload Excel Aplikasi Others</h3>

    <div>
      <h6>Standar Kolom di excel : part_number , nama_barang , qty , po_no </h6>
    </div>

    <a target="_blank" href="https://docs.google.com/spreadsheets/d/1SxHgzk7LKC7yK1SVLoWsfcxRBXk4765lpzpw48fQqwY/edit?usp=sharing">Download Contoh Excel Upload</a>
<div class="container mt-4">
   <!-- Inputan -->
    <div class="row mb-3">
            <div class="col-md-4">
                <label for="no_do_input" class="form-label">No DO</label>
                <input type="text" id="no_do_input" class="form-control" placeholder="Masukkan No DO">
            </div>

            <div class="col-md-4">
                <label for="kode_select" class="form-label">Kode Depan</label>
                <select id="kode_select" class="form-select">
                    <!-- JS akan isi A-Z -->
                </select>
            </div>

            <div class="col-md-4">
                <label for="merk_select" class="form-label">Merk</label>
                <select id="merk_select" class="form-select">
                    <option value="">Pilih Merk</option>
                    <option value="Honda">Honda</option>
                    <option value="Yamaha">Yamaha</option>
                </select>
            </div>
        </div>

        <input type="file" id="excelFile" class="form-control mb-3" accept=".xlsx,.xls" />
        <button id="uploadBtn" class="btn btn-primary">Upload</button>
        <div class="progress mt-3" style="height: 25px; display:none;">
            <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;">0%</div>
        </div>

</div>



    <div class="progress mt-3" style="height: 25px; display:none;">
      <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;">0%</div>
    </div>

    <div class="container"> 
        <nav>
          <ul id="pagination" class="pagination justify-content-center mt-3"></ul>
        </nav>
        <table id="tbl_data_excel" class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>No DO</th>
          <th>Part Number</th>
          <th>Nama Barang</th>
          <th>Qty</th>
          <th>PO No</th>
          <th>Merk</th>
        </tr>
      </thead>
      <tbody>
        <!-- data dari JS akan muncul di sini -->
      </tbody>
    </table>


    </div>


  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>


<script src="./js_upload/load_excel_dian.js"></script>
  <script src="./js_upload/upload_js.js"></script>


  <!-- Load Navbar -->
  <script>
const start = ["G","X"];
const rest = [];
for(let i = 65; i <= 90; i++){ // ASCII A-Z
    const letter = String.fromCharCode(i);
    if(!start.includes(letter)) rest.push(letter);
}

const abjad = [...start, ...rest];
const kodeSelect = document.getElementById("kode_select");
kodeSelect.innerHTML = "";
abjad.forEach(l => {
    const option = document.createElement("option");
    option.value = l;
    option.text = l;
    kodeSelect.appendChild(option);
});



    $(document).ready(function () {
      $("#navbar-container").load("../../component/nav.html", function () {
        setTimeout(loginUser, 500);
      });
    });
  </script>

</body>
</html>
