<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aplikasi Yamaha</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
 
 <script src="../../js/sdk/pocketbase.umd.js"></script>
<script src="../../js/pocket_config.js"></script>

<script>
const pb = new PocketBase(pocketbaseUrl);
</script>
</head>
<body>

  <div id="navbar-container"></div>

   <div class="container mt-5">
    <h3>Upload Excel Aplikasi Others</h3>

    <div>
      <h6>Standar Kolom di excel : part_number , nama_barang , qty , po_no </h6>
    </div>

    <a target="_blank" href="https://docs.google.com/spreadsheets/d/1SxHgzk7LKC7yK1SVLoWsfcxRBXk4765lpzpw48fQqwY/edit?usp=sharing">Download Contoh Excel Upload</a>
<div class="container mt-4">
   <!-- Inputan -->
    <div class="row mb-3">
            <div class="col-md-4">
                <label for="no_do_input" class="form-label fw-bold">No DO ( input angka Do doang )</label>
                <input type="text" id="no_do_input" class="form-control" placeholder="Masukkan No DO">
            </div>

            <div class="col-md-4">
                  <label for="kode_select" class="form-label fw-bold">Kode Depan</label>

                  <!-- Checkbox Manual -->
                  <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" id="manual_kode">
                    <label class="form-check-label fw-bold" for="manual_kode">Input Manual</label>
                  </div>

                  <!-- Select default -->
                  <select id="kode_select" class="form-select">
                      <!-- JS isi A-Z -->
                  </select>

                  <!-- Input manual (disembunyikan dulu) -->
                  <input type="text" id="kode_manual" class="form-control mt-2" placeholder="Masukkan kode manual" style="display:none;">
                </div>


            <div class="col-md-4">
                <label for="merk_select" class="form-label">Merk</label>
                <select id="merk_select" class="form-select">
                    <option value="">Pilih Merk</option>
                    <option value="Honda">Honda</option>
                    <option value="Yamaha">Yamaha</option>
                </select>
            </div>
        </div>

        <input type="file" id="excelFile" class="form-control mb-3" accept=".xlsx,.xls" />
        <button id="uploadBtn" class="btn btn-primary">Upload</button>
        <div class="progress mt-3" style="height: 25px; display:none;">
            <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;">0%</div>
        </div>

</div>



    <div class="progress mt-3" style="height: 25px; display:none;">
      <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;">0%</div>
    </div>


    <div class="container"> 
          <h5>Pencarian nomor DO </h5>
          <p style="color:red;font-weight:bold">
            Untuk Mencari DO Yamaha atau DO Honda cukup angkanya aja misal G.123 maka cukup ketik 123 di pencarian. 
            Jika DO Honda misalnya DOA-123 maka ketik 123 aja
           </p>
          <input type="text" id="search_do" placeholder="cari nomor do" class="form-control"/>
          <button id="btnCari" class="btn btn-success mt-2">Cari DO</button>
        </div>


    <div class="container"> 
        <nav>
          <ul id="pagination" class="pagination justify-content-center mt-3"></ul>
        </nav>
        <table id="tbl_data_excel" class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>No DO</th>
          <th>Part Number</th>
          <th>Nama Barang</th>
          <th>Qty</th>
          <th>PO No</th>
          <th>Merk</th>
        </tr>
      </thead>
      <tbody>
        <!-- data dari JS akan muncul di sini -->
      </tbody>
    </table>


    </div>


  </div>


<!-- Modal Edit -->
<div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit Data</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="editForm">
          <input type="hidden" id="edit-id">
          <div class="mb-2">
            <label class="form-label">No DO</label>
            <input type="text" class="form-control" id="edit-no_do">
          </div>
          <div class="mb-2">
            <label class="form-label">Kode Depan</label>
            <input type="text" class="form-control" id="edit-kode_depan">
          </div>
          <div class="mb-2">
            <label class="form-label">Part Number</label>
            <input type="text" class="form-control" id="edit-part_number">
          </div>
          <div class="mb-2">
            <label class="form-label">Nama Barang</label>
            <input type="text" class="form-control" id="edit-nama_barang">
          </div>
          <div class="mb-2">
            <label class="form-label">Qty</label>
            <input type="number" class="form-control" id="edit-qty">
          </div>
          <div class="mb-2">
            <label class="form-label">PO No</label>
            <input type="text" class="form-control" id="edit-po_no">
          </div>
          <div class="mb-2">
            <label class="form-label">Merk</label>
            <input type="text" class="form-control" id="edit-merk">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
        <button type="button" class="btn btn-primary" id="saveEditBtn">Simpan</button>
      </div>
    </div>
  </div>
</div>


  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>



<script src="./js_upload/load_excel_dian.js"></script>
  <script src="./js_upload/upload_js.js"></script>

<script>
$(document).ready(function () {
  // Setiap kali user mengetik di input No DO
  $("#no_do_input").on("input", function () {
    let val = $(this).val();

    // Hapus semua spasi dan ubah ke huruf besar
    val = val.replace(/\s+/g, "").toUpperCase();

    // Update kembali ke input
    $(this).val(val);
  });
});
</script>


  <!-- Load Navbar -->
  <script>
const start = ["G","X"];
const rest = [];
for(let i = 65; i <= 90; i++){ // ASCII A-Z
    const letter = String.fromCharCode(i);
    if(!start.includes(letter)) rest.push(letter);
}

const abjad = [...start, ...rest];
const kodeSelect = document.getElementById("kode_select");
kodeSelect.innerHTML = "";
abjad.forEach(l => {
    const option = document.createElement("option");
    option.value = l;
    option.text = l;
    kodeSelect.appendChild(option);
});


//manual
// toggle antara select & input manual
document.getElementById("manual_kode").addEventListener("change", function () {
    if (this.checked) {
        document.getElementById("kode_select").style.display = "none";
        document.getElementById("kode_manual").style.display = "block";
    } else {
        document.getElementById("kode_select").style.display = "block";
        document.getElementById("kode_manual").style.display = "none";
    }
});


    $(document).ready(function () {
      $("#navbar-container").load("../../component/nav.html", function () {
        setTimeout(loginUser, 500);
      });
    });
  </script>

</body>
</html>
